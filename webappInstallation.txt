#patanzer
#How to install Massmine-for-the-Masses

GET YOURSELF A VM
	1. Install an Ubuntu VM - 18.04 tested. There's guides for this everywhere, please don't ask us.

BASIC TOOLS TO INSTALL THE REST OF IT
	2. Install git: sudo apt-get install git
	3. Install pip: sudo apt install python3-pip

SETTING UP YOUR VIRTUAL ENVIRONMENT
	4. Install virtualenv: python3 -m pip install virtualenv
	5. Make a working directory: mkdir django
	6. Go into working directoy: cd django
	7. Create virtual enviornment: python3 -m virtualenv environ -p python3
	8. Activate environment: source environ/bin/activate

WHAT TO INSTALL IN YOUR ENVIRONMENT
	9.  Install django: pip install django
	10. Install numpy: pip install numpy
	11. Install matplotlib: pip install matplotlib
	12. Install plotly: pip install plotly
	13. Install cufflinks: pip install cufflinks
	14. Install pandas: pip install pandas
	15. Install the rabbbitmq broker:  sudo apt-get install rabbitmq-server
	16. Install celery for async support: pip install celery
	17. Install django celery backend: pip install django-celery-results 

	NEW: 18.  pip install django-encrypted-model-fields

REPOSITORY CODE INSTALLATION
	19. Get back out: cd
	20. Clone the repository: git clone https://github.com/JoshCMoore/Massmine-for-the-Masses.git
	21. Get into cloned directory: cd Massmine-for-the-Masses
	22. (Developers only) Checkout the right branch (for example, I do: git checkout patanzer)
	23. Get back out to your home directory: cd  
	24. Copy webappproject folder into your virtual environment:
	You want to get the 'webapp' folder from Massmine-for-the-Masses/src and put it into the django directory you just created. You can use a file manager, or else do the following command: cp -a Massmine-for-the-Masses/src/. django/

INSTALING MASSMINE
	For your convenience, Massmine 1.1.0 is included in the webapp folder so you don't have to go download it. The website for it is here: https://www.massmine.org/
	25: Unzip the Massmine zip file: unzip django/webapp/massmine-1.1.0-linux-x86_64 -d django/
	26. Make massmine executable (may ask for your password): sudo ln -s django/massmine/massmine /usr/local/bin
	

MAKING YOUR ENCRYPTION KEYFIXING TIMEZONE ERROR AND OTHER ENVIRONMENT ISSUES
	27. Replace problem variable: sed -i "s/TIME_ZONE/TIME/g" django/environ/lib/python3.6/site-packages/django/utils/timezone.py
	28. Remove any old keys: sed -i '/FIELD_ENCRYPTION_KEY/d' django/webapp/webappproject/settings.py
	29. Add variable to activate script: MYVAR=$( python django/webapp/manage.py generate_encryption_key) && echo "export FIELD_ENCRYPTION_KEY=$MYVAR" >> django/environ/bin/activate
	31. Update settings.py to use the new key: echo "FIELD_ENCRYPTION_KEY = os.environ.get('FIELD_ENCRYPTION_KEY','')" >> django/webapp/webappproject/settings.py


CREATING DATABASE
	32. python django/webapp/manage.py makemigrations
	33. python django/webapp/manage.py migrate --run-syncdb
	34. python django/webapp/manage.py migrate django_celery_results
	OPTIONAL: if you want an admin, do: python django/webapp/manage.py createsuperuser and walk through the options to create one

STARTING THE SERVER
	35. Run your server!: python django/webapp/manage.py runserver


You're done! If you close this environment, you can get back into it by cd'ing into the django folder and running: source environ/bin/activate
   
